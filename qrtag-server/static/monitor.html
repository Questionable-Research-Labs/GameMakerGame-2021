<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta
            name="viewport"
            content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>Document</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"
            integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg=="
            crossorigin="anonymous"></script>
    <script>
      const socket = new WebSocket("ws://qrtag.qrl.nz:4003");

      socket.onmessage = (event) => {
        const json = JSON.parse(event.data);

        console.log(json);

        switch (json['message']) {
          case "ready":
            console.log("Received ready");
            socket.send(JSON.stringify({message: "monitor"}));
            break;
          case "monitor connect":
            if (json["status"] === "accepted") {
              $("#status").html('Connected to server')
            } else {
              $("#status").html('Monitor all ready connected, fuck you')
            }
            break;
          case "update":
            $("#info").html(
`<h1>Players</h1>
<p>${JSON.stringify(json["players"], undefined, 2).replaceAll("\n", "<br />").replaceAll("  ", "\t")}</p>
<h1>Team Scores</h1>
<p>${JSON.stringify(json["teamScores"], undefined, 2).replaceAll("\n", "<br />").replaceAll("  ", "\t")}</p>
<h1>Base Locations</h1>
<p>${JSON.stringify(json["baseLocations"], undefined, 2).replaceAll("\n", "<br />").replaceAll("  ", "\t")}</p>`);
        }
      };

    </script>
</head>
<body>
<p id="status"></p>
<p id="info"></p>
</body>
</html>

